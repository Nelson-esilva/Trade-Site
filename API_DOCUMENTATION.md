# 游댋 API Documentation - Trade Site

## 游늶 칈ndice

1. [Vis칚o Geral](#-vis칚o-geral)
2. [Autentica칞칚o](#-autentica칞칚o)
3. [Endpoints de Autentica칞칚o](#-endpoints-de-autentica칞칚o)
4. [Endpoints de Itens](#-endpoints-de-itens)
5. [Endpoints de Ofertas](#-endpoints-de-ofertas)
6. [Endpoints de Usu치rios](#-endpoints-de-usu치rios)
7. [C칩digos de Status](#-c칩digos-de-status)
8. [Exemplos de Uso](#-exemplos-de-uso)

---

## 游꿢 Vis칚o Geral

A API do Trade Site 칠 baseada em REST e utiliza Django REST Framework. Todas as respostas s칚o em formato JSON.

**Base URL:** `http://localhost:8000/api`

**Content-Type:** `application/json`

---

## 游댏 Autentica칞칚o

A API utiliza **Token Authentication**. Para autenticar, inclua o token no header:

```
Authorization: Token <seu_token_aqui>
```

### Como obter um token:

1. **Login:** `POST /api/auth/login/`
2. **Registro:** `POST /api/auth/register/`

---

## 游댐 Endpoints de Autentica칞칚o

### POST /api/auth/login/

Autentica um usu치rio e retorna um token.

**Request:**
```json
{
  "username": "usuario123",
  "password": "senha123"
}
```

**Response (200):**
```json
{
  "user": {
    "id": 1,
    "username": "usuario123",
    "email": "usuario@email.com",
    "name": "Nome do Usu치rio",
    "is_trade_admin": false,
    "is_superuser": false
  },
  "token": "abc123def456ghi789"
}
```

**Response (401):**
```json
{
  "error": "Credenciais inv치lidas"
}
```

### POST /api/auth/register/

Registra um novo usu치rio e retorna um token.

**Request:**
```json
{
  "username": "novousuario",
  "email": "novo@email.com",
  "name": "Nome Completo",
  "password": "senha123",
  "confirmPassword": "senha123"
}
```

**Response (201):**
```json
{
  "user": {
    "id": 2,
    "username": "novousuario",
    "email": "novo@email.com",
    "name": "Nome Completo"
  },
  "token": "xyz789abc123def456"
}
```

**Response (400):**
```json
{
  "password": ["Password fields didn't match."]
}
```

---

## 游닍 Endpoints de Itens

### GET /api/items/

Lista todos os itens dispon칤veis.

**Headers:**
```
Authorization: Token <token> (opcional)
```

**Query Parameters:**
- `category`: Filtrar por categoria (`livros`, `apostilas`, `equipamentos`, `tecnologia`)
- `status`: Filtrar por status (`disponivel`, `indispon칤vel`, `trocado`)
- `search`: Buscar por t칤tulo ou descri칞칚o
- `ordering`: Ordenar por campo (`created_at`, `title`, `-created_at`, `-title`)

**Response (200):**
```json
{
  "count": 25,
  "next": "http://localhost:8000/api/items/?page=2",
  "previous": null,
  "results": [
    {
      "id": 1,
      "title": "Livro de C치lculo",
      "description": "Livro de c치lculo diferencial e integral",
      "category": "livros",
      "location": "S칚o Paulo, SP",
      "address": "Rua das Flores, 123",
      "image_url": "https://example.com/image.jpg",
      "owner": "usuario123",
      "status": "disponivel",
      "created_at": "2024-01-15T10:30:00Z",
      "updated_at": "2024-01-15T10:30:00Z"
    }
  ]
}
```

### POST /api/items/

Cria um novo item.

**Headers:**
```
Authorization: Token <token>
Content-Type: application/json
```

**Request:**
```json
{
  "title": "Novo Item",
  "description": "Descri칞칚o do item",
  "category": "livros",
  "location": "S칚o Paulo, SP",
  "address": "Rua das Flores, 123",
  "image_url": "https://example.com/image.jpg",
  "status": "disponivel"
}
```

**Response (201):**
```json
{
  "id": 26,
  "title": "Novo Item",
  "description": "Descri칞칚o do item",
  "category": "livros",
  "location": "S칚o Paulo, SP",
  "address": "Rua das Flores, 123",
  "image_url": "https://example.com/image.jpg",
  "owner": "usuario123",
  "status": "disponivel",
  "created_at": "2024-01-15T11:00:00Z",
  "updated_at": "2024-01-15T11:00:00Z"
}
```

### GET /api/items/{id}/

Obt칠m detalhes de um item espec칤fico.

**Headers:**
```
Authorization: Token <token> (opcional)
```

**Response (200):**
```json
{
  "id": 1,
  "title": "Livro de C치lculo",
  "description": "Livro de c치lculo diferencial e integral",
  "category": "livros",
  "location": "S칚o Paulo, SP",
  "address": "Rua das Flores, 123",
  "image_url": "https://example.com/image.jpg",
  "owner": "usuario123",
  "status": "disponivel",
  "created_at": "2024-01-15T10:30:00Z",
  "updated_at": "2024-01-15T10:30:00Z"
}
```

### PUT /api/items/{id}/

Atualiza um item existente.

**Headers:**
```
Authorization: Token <token>
Content-Type: application/json
```

**Request:**
```json
{
  "title": "T칤tulo Atualizado",
  "description": "Nova descri칞칚o",
  "category": "apostilas",
  "location": "Rio de Janeiro, RJ",
  "address": "Av. Copacabana, 456",
  "image_url": "https://example.com/new-image.jpg",
  "status": "disponivel"
}
```

**Response (200):**
```json
{
  "id": 1,
  "title": "T칤tulo Atualizado",
  "description": "Nova descri칞칚o",
  "category": "apostilas",
  "location": "Rio de Janeiro, RJ",
  "address": "Av. Copacabana, 456",
  "image_url": "https://example.com/new-image.jpg",
  "owner": "usuario123",
  "status": "disponivel",
  "created_at": "2024-01-15T10:30:00Z",
  "updated_at": "2024-01-15T12:00:00Z"
}
```

### DELETE /api/items/{id}/

Exclui um item.

**Headers:**
```
Authorization: Token <token>
```

**Response (204):** No Content

### PATCH /api/items/{id}/change_status/

Altera o status de um item.

**Headers:**
```
Authorization: Token <token>
Content-Type: application/json
```

**Request:**
```json
{
  "status": "indispon칤vel"
}
```

**Response (200):**
```json
{
  "id": 1,
  "title": "Livro de C치lculo",
  "description": "Livro de c치lculo diferencial e integral",
  "category": "livros",
  "location": "S칚o Paulo, SP",
  "address": "Rua das Flores, 123",
  "image_url": "https://example.com/image.jpg",
  "owner": "usuario123",
  "status": "indispon칤vel",
  "created_at": "2024-01-15T10:30:00Z",
  "updated_at": "2024-01-15T12:30:00Z"
}
```

---

## 游눯 Endpoints de Ofertas

### GET /api/offers/

Lista ofertas do usu치rio autenticado.

**Headers:**
```
Authorization: Token <token>
```

**Response (200):**
```json
{
  "count": 10,
  "next": null,
  "previous": null,
  "results": [
    {
      "id": 1,
      "item_desired": 5,
      "item_offered": 3,
      "offerer": "usuario123",
      "offer_type": "item",
      "money_amount": null,
      "status": "pendente",
      "created_at": "2024-01-15T14:00:00Z",
      "item_desired_data": {
        "id": 5,
        "title": "Livro de F칤sica",
        "description": "Livro de f칤sica moderna",
        "category": "livros",
        "location": "S칚o Paulo, SP",
        "address": "Rua das Flores, 123",
        "image_url": "https://example.com/physics.jpg",
        "owner": "outrousuario",
        "status": "disponivel",
        "created_at": "2024-01-15T10:30:00Z",
        "updated_at": "2024-01-15T10:30:00Z"
      },
      "item_offered_data": {
        "id": 3,
        "title": "Livro de Qu칤mica",
        "description": "Livro de qu칤mica org칙nica",
        "category": "livros",
        "location": "S칚o Paulo, SP",
        "address": "Rua das Flores, 123",
        "image_url": "https://example.com/chemistry.jpg",
        "owner": "usuario123",
        "status": "disponivel",
        "created_at": "2024-01-15T09:00:00Z",
        "updated_at": "2024-01-15T09:00:00Z"
      }
    }
  ]
}
```

### POST /api/offers/

Cria uma nova oferta.

**Headers:**
```
Authorization: Token <token>
Content-Type: application/json
```

**Request (Oferta de Item):**
```json
{
  "item_desired": 5,
  "item_offered": 3,
  "offer_type": "item"
}
```

**Request (Oferta em Dinheiro):**
```json
{
  "item_desired": 5,
  "offer_type": "money",
  "money_amount": "50.00"
}
```

**Response (201):**
```json
{
  "id": 2,
  "item_desired": 5,
  "item_offered": 3,
  "offerer": "usuario123",
  "offer_type": "item",
  "money_amount": null,
  "status": "pendente",
  "created_at": "2024-01-15T15:00:00Z",
  "item_desired_data": {
    "id": 5,
    "title": "Livro de F칤sica",
    "description": "Livro de f칤sica moderna",
    "category": "livros",
    "location": "S칚o Paulo, SP",
    "address": "Rua das Flores, 123",
    "image_url": "https://example.com/physics.jpg",
    "owner": "outrousuario",
    "status": "disponivel",
    "created_at": "2024-01-15T10:30:00Z",
    "updated_at": "2024-01-15T10:30:00Z"
  },
  "item_offered_data": {
    "id": 3,
    "title": "Livro de Qu칤mica",
    "description": "Livro de qu칤mica org칙nica",
    "category": "livros",
    "location": "S칚o Paulo, SP",
    "address": "Rua das Flores, 123",
    "image_url": "https://example.com/chemistry.jpg",
    "owner": "usuario123",
    "status": "disponivel",
    "created_at": "2024-01-15T09:00:00Z",
    "updated_at": "2024-01-15T09:00:00Z"
  }
}
```

### GET /api/offers/{id}/

Obt칠m detalhes de uma oferta espec칤fica.

**Headers:**
```
Authorization: Token <token>
```

**Response (200):**
```json
{
  "id": 1,
  "item_desired": 5,
  "item_offered": 3,
  "offerer": "usuario123",
  "offer_type": "item",
  "money_amount": null,
  "status": "pendente",
  "created_at": "2024-01-15T14:00:00Z",
  "item_desired_data": {
    "id": 5,
    "title": "Livro de F칤sica",
    "description": "Livro de f칤sica moderna",
    "category": "livros",
    "location": "S칚o Paulo, SP",
    "address": "Rua das Flores, 123",
    "image_url": "https://example.com/physics.jpg",
    "owner": "outrousuario",
    "status": "disponivel",
    "created_at": "2024-01-15T10:30:00Z",
    "updated_at": "2024-01-15T10:30:00Z"
  },
  "item_offered_data": {
    "id": 3,
    "title": "Livro de Qu칤mica",
    "description": "Livro de qu칤mica org칙nica",
    "category": "livros",
    "location": "S칚o Paulo, SP",
    "address": "Rua das Flores, 123",
    "image_url": "https://example.com/chemistry.jpg",
    "owner": "usuario123",
    "status": "disponivel",
    "created_at": "2024-01-15T09:00:00Z",
    "updated_at": "2024-01-15T09:00:00Z"
  }
}
```

### POST /api/offers/{id}/accept/

Aceita uma oferta.

**Headers:**
```
Authorization: Token <token>
```

**Response (200):**
```json
{
  "id": 1,
  "item_desired": 5,
  "item_offered": 3,
  "offerer": "usuario123",
  "offer_type": "item",
  "money_amount": null,
  "status": "aceita",
  "created_at": "2024-01-15T14:00:00Z",
  "item_desired_data": {
    "id": 5,
    "title": "Livro de F칤sica",
    "description": "Livro de f칤sica moderna",
    "category": "livros",
    "location": "S칚o Paulo, SP",
    "address": "Rua das Flores, 123",
    "image_url": "https://example.com/physics.jpg",
    "owner": "outrousuario",
    "status": "indispon칤vel",
    "created_at": "2024-01-15T10:30:00Z",
    "updated_at": "2024-01-15T16:00:00Z"
  },
  "item_offered_data": {
    "id": 3,
    "title": "Livro de Qu칤mica",
    "description": "Livro de qu칤mica org칙nica",
    "category": "livros",
    "location": "S칚o Paulo, SP",
    "address": "Rua das Flores, 123",
    "image_url": "https://example.com/chemistry.jpg",
    "owner": "usuario123",
    "status": "indispon칤vel",
    "created_at": "2024-01-15T09:00:00Z",
    "updated_at": "2024-01-15T16:00:00Z"
  }
}
```

### POST /api/offers/{id}/refuse/

Recusa uma oferta.

**Headers:**
```
Authorization: Token <token>
```

**Response (200):**
```json
{
  "id": 1,
  "item_desired": 5,
  "item_offered": 3,
  "offerer": "usuario123",
  "offer_type": "item",
  "money_amount": null,
  "status": "recusada",
  "created_at": "2024-01-15T14:00:00Z",
  "item_desired_data": {
    "id": 5,
    "title": "Livro de F칤sica",
    "description": "Livro de f칤sica moderna",
    "category": "livros",
    "location": "S칚o Paulo, SP",
    "address": "Rua das Flores, 123",
    "image_url": "https://example.com/physics.jpg",
    "owner": "outrousuario",
    "status": "disponivel",
    "created_at": "2024-01-15T10:30:00Z",
    "updated_at": "2024-01-15T10:30:00Z"
  },
  "item_offered_data": {
    "id": 3,
    "title": "Livro de Qu칤mica",
    "description": "Livro de qu칤mica org칙nica",
    "category": "livros",
    "location": "S칚o Paulo, SP",
    "address": "Rua das Flores, 123",
    "image_url": "https://example.com/chemistry.jpg",
    "owner": "usuario123",
    "status": "disponivel",
    "created_at": "2024-01-15T09:00:00Z",
    "updated_at": "2024-01-15T09:00:00Z"
  }
}
```

---

## 游논 Endpoints de Usu치rios

### GET /api/users/

Lista todos os usu치rios (apenas para administradores).

**Headers:**
```
Authorization: Token <token>
```

**Response (200):**
```json
{
  "count": 10,
  "next": null,
  "previous": null,
  "results": [
    {
      "id": 1,
      "username": "usuario123",
      "email": "usuario@email.com",
      "name": "Nome do Usu치rio",
      "is_trade_admin": false,
      "is_superuser": false,
      "date_joined": "2024-01-15T10:00:00Z"
    }
  ]
}
```

### GET /api/users/me/

Obt칠m dados do usu치rio autenticado.

**Headers:**
```
Authorization: Token <token>
```

**Response (200):**
```json
{
  "id": 1,
  "username": "usuario123",
  "email": "usuario@email.com",
  "name": "Nome do Usu치rio",
  "is_trade_admin": false,
  "is_superuser": false,
  "date_joined": "2024-01-15T10:00:00Z"
}
```

### GET /api/users/{id}/

Obt칠m dados de um usu치rio espec칤fico.

**Headers:**
```
Authorization: Token <token>
```

**Response (200):**
```json
{
  "id": 2,
  "username": "outrousuario",
  "email": "outro@email.com",
  "name": "Outro Usu치rio",
  "is_trade_admin": false,
  "is_superuser": false,
  "date_joined": "2024-01-15T11:00:00Z"
}
```

---

## 游늵 C칩digos de Status

### Sucesso
- **200 OK** - Requisi칞칚o bem-sucedida
- **201 Created** - Recurso criado com sucesso
- **204 No Content** - Requisi칞칚o bem-sucedida, sem conte칰do

### Erro do Cliente
- **400 Bad Request** - Dados inv치lidos
- **401 Unauthorized** - N칚o autenticado
- **403 Forbidden** - Sem permiss칚o
- **404 Not Found** - Recurso n칚o encontrado
- **405 Method Not Allowed** - M칠todo n칚o permitido

### Erro do Servidor
- **500 Internal Server Error** - Erro interno do servidor

---

## 游눠 Exemplos de Uso

### Exemplo 1: Login e Listagem de Itens

```javascript
// 1. Fazer login
const loginResponse = await fetch('http://localhost:8000/api/auth/login/', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    username: 'usuario123',
    password: 'senha123'
  })
});

const loginData = await loginResponse.json();
const token = loginData.token;

// 2. Listar itens
const itemsResponse = await fetch('http://localhost:8000/api/items/', {
  headers: {
    'Authorization': `Token ${token}`
  }
});

const itemsData = await itemsResponse.json();
console.log(itemsData.results);
```

### Exemplo 2: Criar Item e Fazer Oferta

```javascript
// 1. Criar item
const createItemResponse = await fetch('http://localhost:8000/api/items/', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': `Token ${token}`
  },
  body: JSON.stringify({
    title: 'Meu Livro',
    description: 'Livro de matem치tica',
    category: 'livros',
    location: 'S칚o Paulo, SP',
    address: 'Rua das Flores, 123',
    status: 'disponivel'
  })
});

const newItem = await createItemResponse.json();

// 2. Fazer oferta
const createOfferResponse = await fetch('http://localhost:8000/api/offers/', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': `Token ${token}`
  },
  body: JSON.stringify({
    item_desired: 5,
    item_offered: newItem.id,
    offer_type: 'item'
  })
});

const newOffer = await createOfferResponse.json();
```

### Exemplo 3: Aceitar Oferta

```javascript
const acceptOfferResponse = await fetch('http://localhost:8000/api/offers/1/accept/', {
  method: 'POST',
  headers: {
    'Authorization': `Token ${token}`
  }
});

const acceptedOffer = await acceptOfferResponse.json();
```

---

## 游댢 Configura칞칚o de Desenvolvimento

### Vari치veis de Ambiente

```env
# Backend
SECRET_KEY=django-insecure-...
DEBUG=True
ALLOWED_HOSTS=localhost,127.0.0.1
DATABASE_URL=sqlite:///db.sqlite3

# CORS
CORS_ALLOWED_ORIGINS=http://localhost:3000
```

### Testando a API

```bash
# Usando curl
curl -X GET http://localhost:8000/api/items/ \
  -H "Authorization: Token abc123def456ghi789"

# Usando Python requests
import requests

headers = {'Authorization': 'Token abc123def456ghi789'}
response = requests.get('http://localhost:8000/api/items/', headers=headers)
print(response.json())
```

---

**Documenta칞칚o da API atualizada em: Janeiro 2024**
